portal 
======
南大仙林的无线网取消了bras登录方式，上线必须打开浏览器，输入 http://p.nju.edu.cn 然后输入用户名密码，点击确定，下线也必须登录浏览器点击"下线"。

考虑到上线下线操作必须登录浏览器，有些不方便，尤其是对于习惯了在 Linux 终端上操作的人，因此，写了这个小程序，它可以在终端执行上线下线操作。

这个程序还可以记录上线下线的时间，并统计总在线时间。

本程序利用了 cURL 库，所以需要安装这个库。
方法为::

   $ sudo apt-get install libcurl4-openssl-dev

以上是在debian中安装方法，对于其他 debian 衍生系统可以尝试::

   $ apt-cache search libcurl

查找合适的包再重复第一步以安装相应的库。

当然也可以直接下载源代码编译安装这个库。

本归档文件中附带了两个可执行文件，分别是32位版本和64位版本，如果你运气不差，这两个文件的其中一个可以直接执行的话，可跳过编译步骤，将这个文件直接复制到::

   /usr/local/bin

即可

编译安装
--------
首先解压归档文件到一个目录，并进入这个目录。
在终端上输入::

   $ make
   $ make install

卸载方法::
 
   $ make uninstall

使用说明
--------
上线方法::

   $ portal l _帐号 _密码 _记录文件名

或者::

   $ portal l _帐号 _密码

或者::

   $ portal l

所有的这些方法都会首先查找 ~/.portal 中的信息，如果 ~/.portal 中指定了相应信息，则上述指令中提供的 _帐号 _密码 _记录文件名 均无效。对于后两种方法，如果 ~/.portal 也没有指定 _记录文件名 则采用默认值 ~/.portal.record 。对于第三中方法，如果 ~/.portal 没有指定 _帐号 _密码 则报错。

在 ~/.portal 中指定相关信息的方法如下面的例子所示::

   $ echo "b000000000 0000000 /home/username/.portal.record"  > ~/.portal

三个字段分别代表 _帐号 _密码 _记录文件名 。

或者::

   $ echo "b000000000 0000000 > ~/.portal

后一种方法只指定了 _帐号 _密码 省略了 _记录文件名 。

在 ~/.portal 中指定 _记录文件名 的方式的存在主要是为了防止在用不同的用户登录终端时，记录被记在不同的文件中，比如分别记在普通用户和超级用户的 $HOME/.portal.record 文件中，这样会带来麻烦。

下线方法::
   
   $ portal d _记录文件名

或::

   $ portal d

类似地，程序会首先查找 ~/.portal 中是否指定 _记录文件名 ，如果存在，则上述指令中提供的 _记录文件名 无效，对于第二种方法，如果 ~/.portal 也没有指定 _记录文件名 则采用默认值 ~/.portal.record 。

总的来说是 ~/.portal 文件的中的信息的优先级大于输入上述指令时提供的信息，大于默认信息。

由于记录的时间信息不是人类易于理解的，因此，提供了一个方法读取转换上线下线记录文件，当然你也可以自己写脚本转换，我的方法用 awk_ 编写，在这个目录运行::

   $ ./portal_process_record ~/.portal.record

这将打印相应记录，并统计在线时长。

查询当前状态的方法::

   $ portal s

会显示当前是在线还是离线。

作者
----
weibo::

   @Fanchy_Lee
